<?xml version="1.0" encoding="UTF-8"?>
<entities do-package="com.ctrip.hermes.metaservice.model" gen="true">
	<entity name="meta">
		<member name="version" value-type="Long" />
		<query-defs>
			<query name="findLatest" type="SELECT">
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        ORDER BY <FIELD name='id'/> DESC LIMIT 1]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="kv" table="kv" alias="k">
		<var name="key-name" value-type="String" />
		<var name="tag-name" value-type="String" />
		<query-defs>
			<query name="find-by-key" type="SELECT" multiple="true">
				<param name="key-name" />
				<statement><![CDATA[SELECT <FIELDS/>
		        FROM <TABLE/>
		        WHERE <FIELD name='k'/> = ${key-name}]]></statement>
			</query>
			<query name="find-by-tag" type="SELECT" multiple="true">
				<param name="tag-name" />
				<statement><![CDATA[SELECT <FIELDS/>
		        FROM <TABLE/>
		        WHERE <FIELD name='tag'/> = ${tag-name}]]></statement>
			</query>
			<query name="find-all" type="SELECT" multiple="true">
				<statement><![CDATA[
				SELECT <FIELDS/>
        		FROM <TABLE/>
        		]]></statement>
			</query>
			<query name="update-by-PK" type="UPDATE">
				<param name="key-name" />
				<statement><![CDATA[UPDATE <TABLE/>
		        SET <FIELDS/>
		        WHERE <FIELD name='id'/> = ${key-id}]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="monitor-event" table="monitor_event" alias="me">
		<var name="type" value-type="int" />
		<var name="count" value-type="int" />
		<var name="start" value-type="long" />
		<var name="end" value-type="long" />
		<var name="page-count" value-type="int" />
		<var name="id-offset" value-type="long" />
		<member name="total" value-type="long" select-expr="COUNT(*)" all="false" />

		<readsets>
			<readset name="COUNT">
				<member name="total" />
			</readset>
		</readsets>

		<query-defs>
			<query name="total-count" type="SELECT" multiple="false">
				<statement><![CDATA[
				SELECT <FIELDS/>
		        FROM <TABLE/>
				]]></statement>
			</query>
			<query name="find-events-batch" type="SELECT" multiple="true">
				<param name="page-count" />
				<param name="id-offset" />
				<statement><![CDATA[
				SELECT <FIELDS/>
		        FROM <TABLE/>
		        ORDER BY <FIELD name='id'/> DESC
		        LIMIT ${id-offset},${page-count}]]></statement>
			</query>
			<query name="update-notified-status" type="UPDATE" batch='true'>
				<statement>
				<![CDATA[
				UPDATE <TABLE/>
		        SET <FIELD name='notify-time'/> = NOW()
		        WHERE <FIELD name='id'/> = ${id}
		        ]]>
				</statement>
			</query>
			<query name="find-unnotified-events" type="SELECT" multiple="true">
				<statement><![CDATA[
				SELECT <FIELDS/>
		        FROM <TABLE/>
		        WHERE <FIELD name='notify-time'/> IS NULL 
		        AND 
		        (<FIELD name='should-notify' /> IS NULL OR <FIELD name='should-notify' />=1) 
		        ORDER BY <FIELD name='id'/> DESC]]></statement>
			</query>
			<query name="find-by-type-within-time-range" type="SELECT" multiple="true">
				<param name="type" />
				<param name="start" />
				<param name="end" />
				<statement><![CDATA[
				SELECT <FIELDS/>
		        FROM <TABLE/>
		        WHERE <FIELD name='event-type'/> = ${type} 
		        AND <FIELD name='create-time'/> >= ${start} 
		        AND <FIELD name='create-time'/> <= ${end} 
		        ORDER BY <FIELD name='id'/> DESC]]></statement>
			</query>
			<query name="find-by-time-range" type="SELECT" multiple="true">
				<param name="start" />
				<param name="end" />
				<statement><![CDATA[
				SELECT <FIELDS/>
		        FROM <TABLE/>
		        WHERE <FIELD name='create-time'/> >= ${start} 
		        AND <FIELD name='create-time'/> <= ${end} 
		        ORDER BY <FIELD name='id'/> DESC]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="notification" table="notification" alias="n">
		<var name="type" value-type="String" />
		<var name="count" value-type="int" />
		<var name="start" value-type="long" />
		<var name="end" value-type="long" />
		<var name="page-count" value-type="int" />
		<var name="id-offset" value-type="long" />
		<var name="include-days" value-type="int" />
		<member name="total" value-type="long" select-expr="COUNT(*)" all="false" />

		<readsets>
			<readset name="COUNT">
				<member name="total" />
			</readset>
		</readsets>
		<updatesets>
			<updateset name="NOTIFY_TIME">
				<member name="notify-time" />
			</updateset>
		</updatesets>
		<query-defs>
			<query name="total-count" type="SELECT" multiple="false">
				<statement><![CDATA[
				SELECT <FIELDS/>
		        FROM <TABLE/>
				]]></statement>
			</query>
			<query name="find-notification-batch" type="SELECT" multiple="true">
				<param name="page-count" />
				<param name="id-offset" />
				<statement><![CDATA[
				SELECT <FIELDS/>
		        FROM <TABLE/>
		        ORDER BY <FIELD name='id'/> DESC
		        LIMIT ${id-offset},${page-count}]]></statement>
			</query>
			<query name="update-notified-status" type="UPDATE" batch='true'>
				<statement>
				<![CDATA[
				UPDATE <TABLE/>
		        SET <FIELD name='notify-time'/> = NOW()
		        WHERE <FIELD name='id'/> = ${id}
		        ]]>
				</statement>
			</query>
			<query name="update-notified-status-by-ref-key" type="UPDATE" batch='true'>
				<statement>
				<![CDATA[
				UPDATE <TABLE/>
		        SET <FIELD name='notify-time'/> = NOW()
		        WHERE <FIELD name='ref-key'/> = ${ref-key}
		        ]]>
				</statement>
			</query>
			<query name="find-unnotified-notifications" type="SELECT" multiple="true">
				<param name="type" />
				<param name="include-days" />
				<statement><![CDATA[
				SELECT <FIELDS/>
		        FROM <TABLE/>
		        WHERE <FIELD name='notify-time'/> IS NULL
		        AND <FIELD name='notification-type'/> = ${type}
		        AND <FIELD name='create-time' /> >= (CURDATE() - INTERVAL ${include-days} DAY)
		        ORDER BY <FIELD name='id'/> DESC]]></statement>
			</query>
			<query name="find-by-type-within-time-range" type="SELECT" multiple="true">
				<param name="type" />
				<param name="start" />
				<param name="end" />
				<statement><![CDATA[
				SELECT <FIELDS/>
		        FROM <TABLE/>
		        WHERE <FIELD name='notification-type'/> = ${type} 
		        AND <FIELD name='create-time'/> >= ${start} 
		        AND <FIELD name='create-time'/> <= ${end} 
		        ORDER BY <FIELD name='id'/> DESC]]></statement>
			</query>
			<query name="find-by-time-range" type="SELECT" multiple="true">
				<param name="start" />
				<param name="end" />
				<statement><![CDATA[
				SELECT <FIELDS/>
		        FROM <TABLE/>
		        WHERE <FIELD name='create-time'/> >= ${start} 
		        AND <FIELD name='create-time'/> <= ${end} 
		        ORDER BY <FIELD name='id'/> DESC]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="schema">
		<member name="avroid" value-type="Integer" />
		<var name="tId" value-type="long" />
		<var name="aId" value-type="int" />
		<query-defs>
			<query name="findByTopic" type="SELECT" multiple="true">
				<param name="tId" />
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        WHERE <FIELD name='topic-id'/> = ${tId} ORDER BY <FIELD name='version'/> DESC]]></statement>
			</query>
			<query name="getMaxVersionByTopic" type="SELECT">
				<param name="tId" />
				<statement><![CDATA[SELECT <FIELDS/>
		FROM <TABLE/>
		WHERE <FIELD name='topic-id'/> = ${tId} ORDER BY <FIELD name='version'/> DESC]]>
				</statement>
			</query>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        ORDER BY <FIELD name='id'/> DESC]]></statement>
			</query>
			<query name="listLatest" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
		FROM <TABLE/>
		WHERE <FIELD name='id'/> IN 
		(SELECT MAX(<FIELD name='id'/>) FROM <TABLE/> GROUP BY <FIELD name='topic-id'/>)]]>
				</statement>
			</query>
			<query name="findByAvroid" type="SELECT">
				<param name="aId" />
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        WHERE <FIELD name='avro-id'/> = ${aId}]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="subscription">
		<var name="tStatus" value-type="String" />
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        ORDER BY <FIELD name='id'/> DESC]]></statement>
			</query>
			<query name="findByStatus" type="SELECT" multiple="true">
				<param name="tStatus" />
				<statement><![CDATA[SELECT <FIELDS/>
      	FROM <TABLE/>
      	WHERE <FIELD name='status'/> = ${tStatus} ]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="app">
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/> ]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="codec">
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/> ]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="consumer-group">
		<member name="ack-timeout-seconds" value-type="Integer" />
		<member name="ordered-consume" value-type="Boolean" />
		<member name="enabled" value-type="Boolean" />
		<var name="tId" value-type="long" />
		<var name="cName" value-type="String" />
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
		FROM <TABLE/> ]]></statement>
			</query>
			<query name="find-by-topicId" type="SELECT" multiple="true">
				<param name="tId" />
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        WHERE <FIELD name='topic-id'/> = ${tId} ]]></statement>
			</query>
			<query name="find-by-topicId-and-name" type="SELECT">
				<param name="tId" />
				<param name="cName" />
				<statement><![CDATA[SELECT <FIELDS/>
		FROM <TABLE/>
		WHERE <FIELD name='topic-id'/> = ${tId} AND <FIELD name='name'/> = ${cName} ]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="datasource">
		<var name="sType" value-type="String" />
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
		FROM <TABLE/> ]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="endpoint">
		<member name="port" value-type="Integer" />
		<member name="enabled" value-type="Boolean" />
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/> ]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="partition">
		<var name="tId" value-type="long" />
		<var name="pId" value-type="int" />
		<member name="count" value-type="int" select-expr="COUNT(*)" all="false" />
		<readsets>
			<readset name="COUNT">
				<member name="count" />
			</readset>
		</readsets>
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
		FROM <TABLE/> ]]></statement>
			</query>
			<query name="find-by-topicId" type="SELECT" multiple="true">
				<param name="tId" />
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        WHERE <FIELD name='topic-id'/> = ${tId} ]]></statement>
			</query>
			<query name="delete-by-topicId" type="DELETE">
				<param name="tId" />
				<param name="pId" />
				<statement><![CDATA[DELETE FROM <TABLE/>
		WHERE <FIELD name='topic-id'/> = ${tId} AND <FIELD name='id'/> = ${pId} ]]></statement>
			</query>
			<query name="update-by-topic-and-partition" type="UPDATE">
				<param name="tId" />
				<param name="pId" />
				<statement><![CDATA[UPDATE <TABLE/>
        SET <FIELDS/>
        WHERE <FIELD name='topic-id'/> = ${tId}
        AND <FIELD name='id'/> = ${pId}]]></statement>
			</query>
			<query name="count-by-datasource" type="SELECT">
				<param name="read-datasource" />
				<statement><![CDATA[SELECT <FIELDS/>
		FROM <TABLE/> WHERE <FIELD name='read-datasource'/> = ${read-datasource}]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="producer">
		<var name="tId" value-type="long" />
		<query-defs>
			<query name="find-by-topicId" type="SELECT" multiple="true">
				<param name="tId" />
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        WHERE <FIELD name='topic-id'/> = ${tId} ]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="server">
		<member name="enabled" value-type="Boolean" />
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/> ]]></statement>
			</query>
			<query name="find-by-id" type="SELECT" multiple="true">
				<param name="id" />
				<statement><![CDATA[
					SELECT <FIELDS/>
	        		FROM <TABLE/>
	        		WHERE <FIELD name="id"/> =${id} 
        		]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="storage">
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/> ]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="topic">
		<member name="partition-count" value-type="Integer" />
		<member name="schema-id" value-type="Long" />
		<member name="ack-timeout-seconds" value-type="Integer" />
		<member name="storage-partition-size" value-type="Long" />
		<member name="resend-partition-size" value-type="Long" />
		<member name="storage-partition-count" value-type="Integer" />
		<member name="priority-message-enabled" value-type="Boolean" />
		<var name="tName" value-type="String" />
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/> ]]></statement>
			</query>
			<query name="find-by-name" type="SELECT">
				<param name="tName" />
				<statement><![CDATA[SELECT <FIELDS/>
		FROM <TABLE/>
		WHERE <FIELD name='name'/> = ${tName} ]]>
				</statement>
			</query>
		</query-defs>
	</entity>
	<entity name="producer-monitor-config">
		<query-defs>
			<query name="find-by-topic" type="SELECT" multiple="true">
				<param name="topic" />
				<statement>
				<![CDATA[
					SELECT <FIELDS/>
        			FROM <TABLE/>
        			WHERE <FIELD name='topic'/> = ${topic} 
        		]]></statement>
			</query>
			<query name="list" type="SELECT" multiple="true">
				<statement>
				<![CDATA[
					SELECT <FIELDS/>
        			FROM <TABLE/>
        		]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="consumer-monitor-config">
		<query-defs>
			<query name="find-by-topic" type="SELECT" multiple="true">
				<param name="topic" />
				<statement>
				<![CDATA[
					SELECT <FIELDS/>
        			FROM <TABLE/>
        			WHERE <FIELD name='topic'/> = ${topic} 
        		]]></statement>
			</query>
			<query name="find-by-topic-consumer" type="SELECT" multiple="true">
				<param name="topic" />
				<param name="consumer" />
				<statement>
				<![CDATA[
					SELECT <FIELDS/>
        			FROM <TABLE/>
        			WHERE <FIELD name='topic'/> = ${topic} 
        			AND <FIELD name='consumer'/> = ${consumer} 
        		]]></statement>
			</query>
			<query name="list" type="SELECT" multiple="true">
				<statement>
				<![CDATA[
					SELECT <FIELDS/>
        			FROM <TABLE/>
        		]]></statement>
			</query>
		</query-defs>
	</entity>
	<entity name="idc">
		<query-defs>
			<query name="list" type="SELECT" multiple="true">
				<statement><![CDATA[
					SELECT <FIELDS/>
	        		FROM <TABLE/>
        		]]></statement>
			</query>
			<query name="find-by-id" type="SELECT" multiple="true">
				<param name="id" />
				<statement><![CDATA[
					SELECT <FIELDS/>
	        		FROM <TABLE/>
	        		WHERE <FIELD name="id"/> =${id} 
        		]]></statement>
			</query>
			<query name="find-by-primary-status" type="SELECT" multiple="true">
				<param name="primary" />
				<statement><![CDATA[
					SELECT <FIELDS/>
	        		FROM <TABLE/>
	        		WHERE <FIELD name="primary"/> = ${primary}
        		]]></statement>
			</query>
			<query name="find-by-enabled-status" type="SELECT" multiple="true">
				<param name="enabled" />
				<statement><![CDATA[
					SELECT <FIELDS/>
	        		FROM <TABLE/>
	        		WHERE <FIELD name="enabled"/> = ${enabled}
        		]]></statement>
			</query>
			<query name="set-primary-by-id" type="UPDATE">
				<param name="id" />
				<statement><![CDATA[
					UPDATE <TABLE/>
					SET <FIELD name='primary'/> = TRUE
					WHERE <FIELD name='id'/> = ${id}
       			]]></statement>
			</query>
			<query name="set-not-primary-by-id" type="UPDATE">
				<param name="id" />
				<statement><![CDATA[
					UPDATE <TABLE/>
					SET <FIELD name='primary'/> = FALSE
					WHERE <FIELD name='id'/> = ${id}
       			]]></statement>
			</query>
			<query name="set-enabled-status-by-id" type="UPDATE">
				<param name="id" />
				<param name="enabled" />
				<statement><![CDATA[
					UPDATE <TABLE/>
					SET <FIELD name='enabled'/> = ${enabled}
					WHERE <FIELD name='id'/> = ${id}
       			]]></statement>
			</query>
		</query-defs>
	</entity>
</entities>

