<div>
	<div class="panel panel-info">
		<div class="panel-heading">Hermes 消费者列表</div>
		<table class="table table-hover" ng-if="consumers" st-safe-src="consumers" st-table="filteredConsumers">
			<thead>
				<tr>
					<th st-sort="name">消费集群</th>
					<th st-sort="appIds">应用</th>
					<th st-sort="topicName">Topic名称</th>
					<th st-sort="orderedConsume">有序</th>
					<th st-sort="retryPolicy">重试策略</th>
					<th st-sort="owner1">负责人1</th>
					<th st-sort="phone1">手机1</th>
					<th ng-if="logined" style="text-align: left;"><button type="button" data-toggle="modal" data-target="#add-consumer-modal" class="btn btn-xs btn-success" style="text-align: center;">新增</button></th>
				</tr>
				<tr>
					<th><input st-search="name" placeholder="Group" class="input-sm form-control" type="search" ng-model-options="{updateOn:'blur'}" /></th>
					<th><input st-search="appIds" placeholder="App" class="input-sm form-control" type="search" ng-model-options="{updateOn:'blur'}" /></th>
					<th><input st-search="topicName" placeholder="Topic" class="input-sm form-control" type="search" ng-model-options="{updateOn:'blur'}" /></th>
					<th><input st-search="orderedConsume" placeholder="OrderedConsume" class="input-sm form-control" type="search" ng-model-options="{updateOn:'blur'}" /></th>
					<th><input st-search="retryPolicy" placeholder="Retry" class="input-sm form-control" type="search" ng-model-options="{updateOn:'blur'}" /></th>
					<th><input st-search="owner1" placeholder="Owner1" class="input-sm form-control" type="search" ng-model-options="{updateOn:'blur'}" /></th>
					<th><input st-search="phone1" placeholder="Phone1" class="input-sm form-control" type="search" ng-model-options="{updateOn:'blur'}" /></th>
					<th ng-if="logined" ></th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="consumer in filteredConsumers">
					<td><a href="/console/consumer#/detail/{{consumer.topicName}}/{{consumer.name}}"><span e-form="rowform" ng-bind="consumer.name" e-name="name"></a></td>
					<td><span e-form="rowform" editable-text="consumer.appIds" ng-bind="consumer.appIds" e-name="appIds"></td>
					<td><span e-form="rowform" ng-bind="consumer.topicName" e-name="topicName"></td>
					<td><span e-form="rowform" editable-select="consumer.orderedConsume" ng-bind="consumer.orderedConsume" e-name="orderedConsume" e-ng-options="order for order in order_opts"></td>
					<td><span e-form="rowform" editable-text="consumer.retryPolicy" ng-bind="consumer.retryPolicy" e-name="retryPolicy"></td>
					<td><span e-form="rowform" editable-text="consumer.owner1" ng-bind="consumer.owner1" e-name="owner1"></td>
					<td><span e-form="rowform" editable-text="consumer.phone1" ng-bind="consumer.phone1" e-name="phone1"></td>
					<td ng-if="logined" style="white-space: nowrap">
						<form editable-form name="rowform" onbeforesave="update_consumer($data,consumer.topicName,consumer.name)" ng-show="rowform.$visible">
							<button type="submit" ng-disabled="rowform.$waiting" class="btn btn-xs btn-primary">保存</button>
							<button type="button" ng-disabled="rowform.$waiting" ng-click="rowform.$cancel()" class="btn btn-xs btn-default">取消</button>
						</form>
						<div class="buttons" ng-show="!rowform.$visible">
							<button type="button" ng-click="rowform.$show()" class="btn btn-xs btn-warning" style="text-align: center;">修改</button>
							<button type="button" ng-click="confirmDeletion(consumer.topicName, consumer.name)" class="btn btn-xs btn-danger" style="text-align: center;">删除</button>
						</div>
					</td>
				</tr>
			</tbody>
			<tfoot>
				<tr>
					<td class="text-center" colspan="7" pagination-x page-size="10"></td>
				</tr>
			</tfoot>
		</table>
	</div>
	<div class="modal fade" id="add-consumer-modal" tabindex="-1" role="dialog" aria-labelledby="add-consumer-label" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title" id="add-consumer-label">新增 Consumer</h4>
				</div>
				<div class="modal-body">
					<form class="form-horizontal">
						<div class="form-group">
							<label for="inputTopicName" class="col-sm-3 control-label">Topic名称</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" id="inputTopicName" placeholder="Topic Name" ng-model="newTopicNames">
							</div>
						</div>
						<div class="form-group">
							<label for="inputName" class="col-sm-3 control-label">消费集群名称</label>
							<div class="col-sm-8">
								<input class="form-control" id="inputName" placeholder="Consumer Group Name" ng-model="newConsumer.name">
							</div>
						</div>
						<div class="form-group">
							<label for="inputOrderedConsume" class="col-sm-3 control-label">保证按序消费</label>
							<div class="col-sm-3">
								<select name="ordered-consume" class="form-control" id="inputOrderedConsume" ng-model="newConsumer.orderedConsume" ng-options="order for order in order_opts">
								</select>
							</div>
						</div>
						<div class="form-group">
							<label for="inputAppIds" class="col-sm-3 control-label">应用名称</label>
							<div class="col-sm-8">
								<input class="form-control" id="inputAppIds" placeholder="App Name" ng-model="newConsumer.appIds">
							</div>
						</div>
						<div class="form-group">
							<label for="inputRetryPolicy" class="col-sm-3 control-label">消费重试策略</label>
							<div class="col-sm-8">
								<input class="form-control" id="inputRetryPolicy" placeholder="Consume Retry Policy" ng-model="newConsumer.retryPolicy">
							</div>
						</div>
						<div class="form-group">
							<label for="inputAckTimeoutSeconds" class="col-sm-3 control-label">ACK 超时</label>
							<div class="col-sm-3">
								<input class="form-control" id="inputAckTimeoutSeconds" placeholder="ACK Timeout in Seconds" ng-model="newConsumer.ackTimeoutSeconds">
							</div>
						</div>
						<div class="form-group">
							<label for="inputOwner1" class="col-sm-3 control-label">负责人1</label>
							<div class="col-sm-3">
								<input class="form-control" id="inputOwner1" ng-model="newConsumer.owner1">
							</div>
						</div>
						<div class="form-group">
							<label for="inputPhone1" class="col-sm-3 control-label">电话1</label>
							<div class="col-sm-3">
								<input class="form-control" id="inputPhone1" ng-model="newConsumer.phone1">
							</div>
						</div>
						<div class="form-group">
							<label for="inputOwner2" class="col-sm-3 control-label">负责人2</label>
							<div class="col-sm-3">
								<input class="form-control" id="inputOwner2" ng-model="newConsumer.owner2">
							</div>
						</div>
						<div class="form-group">
							<label for="inputPhone2" class="col-sm-3 control-label">电话2</label>
							<div class="col-sm-3">
								<input class="form-control" id="inputPhone2" ng-model="newConsumer.phone2">
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-sm btn-danger" data-dismiss="modal">关闭</button>
					<button type="button" class="btn btn-sm btn-success" data-dismiss="modal" ng-click="addConsumer(newConsumer)">保存</button>
				</div>
			</div>
		</div>
	</div>
	<loading-x></loading-x>
	<confirm-dialog-x id="deletionConfirm" title="删除" content="您确定要删除Consumer[{{consumerName}}]" action="deleteConsumer"></confirm-dialog-x>
</div>

